{% extends "base.html" %}

{% block title %}Edit Research Brief{% endblock %}

{% block extra_css %}
<link rel="stylesheet" href="{{ url_for('static', filename='css/research.css') }}">
{% endblock %}

{% block content %}
<div class="research-container">
    <div class="research-header">
        <h1>Edit Research Brief</h1>
        <a href="{{ url_for('research_view', id=brief.id) }}" class="btn btn-secondary">
            <i class="fas fa-arrow-left"></i> Back to Brief
        </a>
    </div>

    <div class="research-form-card">
        <form method="POST">
            {{ form.hidden_tag() }}
            
            <div class="form-section">
                <div class="form-group">
                    {{ form.title.label(class="form-label") }}
                    {{ form.title(class="form-control") }}
                    {% if form.title.errors %}
                        <div class="text-danger">
                            {% for error in form.title.errors %}
                                <small>{{ error }}</small>
                            {% endfor %}
                        </div>
                    {% endif %}
                </div>
            </div>

            <div class="form-section">
                <div class="form-group">
                    {{ form.citation.label(class="form-label") }}
                    {{ form.citation(class="form-control") }}
                    {% if form.citation.errors %}
                        <div class="text-danger">
                            {% for error in form.citation.errors %}
                                <small>{{ error }}</small>
                            {% endfor %}
                        </div>
                    {% endif %}
                </div>
            </div>

            <div class="form-section">
                <div class="form-group">
                    {{ form.url.label(class="form-label") }}
                    {{ form.url(class="form-control") }}
                    <small class="form-text text-muted">Enter the URL to the source article (optional, but recommended for easy access).</small>
                    {% if form.url.errors %}
                        <div class="text-danger">
                            {% for error in form.url.errors %}
                                <small>{{ error }}</small>
                            {% endfor %}
                        </div>
                    {% endif %}
                </div>
            </div>

            <div class="form-section">
                <div class="form-group">
                    {{ form.summary.label(class="form-label") }}
                    {{ form.summary(class="form-control") }}
                    <small class="form-text text-muted">Use bullet points (â€¢) or new lines for each point.</small>
                    {% if form.summary.errors %}
                        <div class="text-danger">
                            {% for error in form.summary.errors %}
                                <small>{{ error }}</small>
                            {% endfor %}
                        </div>
                    {% endif %}
                </div>
            </div>

            <div class="form-section">
                <div class="form-group">
                    {{ form.tags.label(class="form-label") }}
                    <div class="tags-input-wrapper">
                        {{ form.tags(class="form-control tags-input") }}
                        <small class="form-text text-muted">
                            <i class="fas fa-info-circle"></i> Enter tags separated by commas (e.g., ai, research, machine-learning)
                        </small>
                    </div>
                    {% if form.tags.errors %}
                        <div class="text-danger">
                            {% for error in form.tags.errors %}
                                <small>{{ error }}</small>
                            {% endfor %}
                        </div>
                    {% endif %}
                    {% if brief.tags.count() > 0 %}
                        <div class="current-tags-display">
                            <strong>Current tags:</strong>
                            {% for tag in brief.tags.all() %}
                                <span class="tag-badge-display">
                                    <i class="fas fa-tag"></i> {{ tag.name }}
                                </span>
                            {% endfor %}
                        </div>
                    {% endif %}
                </div>
            </div>

            <div class="form-actions">
                {{ form.submit(class="btn btn-primary btn-lg") }}
                <a href="{{ url_for('research_view', id=brief.id) }}" class="btn btn-secondary btn-lg">Cancel</a>
            </div>
        </form>
    </div>
</div>
{% endblock %}

{% block extra_js %}
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
{% endblock %}
